@model guestACCESS.ClientWeb.Models.EventGroupModel
@using guestACCESS.ClientWeb
@using SharedLib
@using guestACCESS.ClientWeb
@using guestACCESS.eCommerce
@using guestACCESS.eCommerce.ProgramSource
@{ 
    ViewBag.Title = "Details";
    Layout = "~/Views/Shared/_LayoutCatalog.cshtml";
    var tripInfo = new guestACCESS.eCommerce.ProgramSource.ProgramEventSource(Model.EventEntity.TripId).GetProgram(); 
}
@section HeadContent {
    @*<link href="/Content/plugins/OwlCarousel/assets/owl.carousel.min.css" rel="stylesheet" />*@
    <link href="~/Content/plugins/intlTelInput/intlTelInput.css" rel="stylesheet" />
    <link href="/Content/plugins/OwlCarousel/assets/owl.theme.default.min.css" rel="stylesheet" />
    <style>
        a.eo-item.eoi-btn.btn.btn-primary.btn-sm.right {
            border: 0;
            color: #fff;
            background-color: #9c27b0;
            border-color: #9c27b0;
            box-shadow: 0 2px 2px 0 rgba(156, 39, 176, 0.14), 0 3px 1px -2px rgba(156, 39, 176, 0.2), 0 1px 5px 0 rgba(156, 39, 176, 0.12);
            flex-basis: 10%;
            text-align: center;
        }

        ul.event-options li .eoi-date {
            flex-basis: 10%;
        }

        ul.event-options li .eoi-guest {
            flex-basis: 10%;
        }

        ul.event-options li .eoi-usd {
            flex-basis: 10%;
        }
    </style>
}
@section FootContent {
    <script src="/Content/plugins/jQuery-cookie/jquery.cookie.js"></script>
    <script src="/Content/dist/js/paginationObject.js"></script>
    <script src="/Content/pageScripts/ec_PTE.js"></script>
    <script src="/Content/pageScripts/ec_Tariff.js"></script>
    <script src="/Content/pageScripts/ec_CartParticipant.js"></script>
    @*<script src="/Content/Fairmont/css/2015/Bootstrap/js/bootstrap.min.js"></script>
        <script src="/Content/proposal/js/popper.min.js"></script>*@
    <script src="~/Content/assets/jaunt2/js/library/owl.carousel.min.js"></script>
    <script src="~/Content/plugins/intlTelInput/intlTelInput-jquery.min.js"></script>
    @*<script src="~/Content/plugins/OwlCarousel/owl.carousel.min.js"></script>*@
    <script>
        $(document).ready(function () {

            Tariff.ProgramId = parseInt('@Model.EventEntity.TripId');
            Tariff.RemoveUrl = "@Url.Action("Remove", "ShoppingCart")";
            Tariff.WelcomeUrl = "@Url.Action("Welcome", "Tariff")";
            Tariff.BookHotelUrl = "@Url.Action("BookHotel", "Tariff")";
            Tariff.ShoppingCartUrl = "@Url.Action("Index", "ShoppingCart")";
            Tariff.EventGroupUrl = "@Url.Action("EventGroup","Tariff")";
            Tariff.checkOutUrl = "@Url.Action("Index","Summary")";
            Tariff.discardChangeUrl = "@Url.Action("DiscardChange","Summary")";
            Tariff.showQty = "@tripInfo.EnableOpenToWebPaxQuantity";
            Tariff.IsPreview = "False";
            Tariff.Init();
            Tariff.SetEventCount();
        });
    </script>
}
@{ var cart = ShoppingCart.GetShoppingCartofCurrentUser();
    var eventTypes = ViewData["EventTypes"] as Dictionary<int, guestACCESS.DataAccess.Entity.T_GASDataEventType>;
    var trip = new guestACCESS.Kernel.TripManagement.Trip(Model.EventEntity.TripId); }
<!-- Main -->
<div class="main main-dt">
    <div class="container">
        <div class="main-cn detail-page bg-white clearfix">

            <section class="breakcrumb-sc">
                <ul class="breadcrumb arrow">
                    <li><a onclick="javascript:history.back()"> <i class="fa fa-home"></i></a></li>
                    <li><a href="javascript:void(0);" title="">Events</a></li>
                    <li>@Model.EventEntity.EventName</li>
                </ul>
            </section>

            <!-- Header Detail -->
            <section class="head-detail">
                <div class="head-dt-cn">
                    <div class="row">
                        <div class="col-sm-7">
                            <h1>@Model.EventEntity.EventName</h1>
                        </div>

                    </div>
                </div>
            </section>
            <!-- End Header Detail -->
            <!-- Detail Slide -->
            <section class="detail-slider">
                <!-- Lager Image -->
                @{ var media = Model.EventEntity.CustomizedEventMedia.Where(t => t.MediaType == MediaType.Image || t.MediaType == MediaType.Video);}

                <div class="slide-room-lg">
                    <div id="slide-room-lg">
                        @foreach (var m in media.OrderBy(a => a.MediaType))
                        {
                            if (m.MediaType == MediaType.Image)
                            {
                                string tempImg = HelperExtensions.ParseImagePath(m.MediaContent);
                                <img src="@tempImg" alt="">
                            }
                        }
                    </div>
                </div>
                <!-- End Lager Image -->
                <!-- Thumnail Image -->
                <div class="slide-room-sm">
                    <div class="row">
                        <div class="col-md-8 col-md-offset-2">
                            <div id="slide-room-sm">
                                @foreach (var m in media.OrderBy(a => a.MediaType))
                                {
                                    if (m.MediaType == MediaType.Image)
                                    {
                                        string tempImg = HelperExtensions.ParseImagePath(m.MediaContent);

                                        <img src="@tempImg" alt="">
                                    }
                                }
                            </div>
                        </div>
                    </div>
                </div>
                <!-- End Thumnail Image -->
            </section>
            <!-- End Detail Slide -->
            <!-- Tour Overview -->
            <section class="tour-overview detail-cn" id="tour-overview">
                <div class="row">

                    <!-- Tour Overview Content -->
                    <div class="col-lg-12 tour-overview-cn">
                        <div class="row">
                            <div class="col-lg-9">
                                <!-- Description -->
                                <div class="tour-description">
                                    <h2 class="title-detail">
                                        Description
                                    </h2>
                                    <div class="tour-detail-text" style="padding-right: 30px;">
                                        <p>


                                            @Html.Raw(Model.EventEntity.CustomizedEventMedia.HtmlDescription)
                                        </p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                @foreach (var m in media.OrderBy(a => a.MediaType))
                                {
                                    if (!string.IsNullOrEmpty(m.MediaContent))
                                    {
                                        if (m.MediaType == MediaType.Video)
                                        {
                                            var source = SharedLib.Html.HtmlHelper.GetSourceFromIframe(m.MediaContent);
                                            if (source != "")
                                            {
                                                <div class="item-video pull-right">
                                                    <iframe width="300" height="245" src="@source"></iframe>
                                                </div>
                                            }
                                        }

                                    }
                                }

                            </div>
                        </div>
                        @if (Model.EventGroupId > 0)
                        {
                            <div class="modal-event-list">

                                <h4>Scroll for Options </h4>
                                <ul class="event-options">
                                    @{var eventItems = Model.GetListByEventGroup(); }
                                    @foreach (var events in eventItems)
                                    {

                                        var addedEvent = cart.GetAddedEvent(events.EventId, true);
                                        <li>
                                            <a class="eo-item eoi-event" data-eventid="@events.EventId">
                                                @events.EventName
                                                @if (events.HostedEvent)
                                                {
                                                    <span class='red'>(This is a hosted event. No Payment needed)</span>
                                                }
                                            </a>
                                            <span class="eo-item eoi-date">
                                                @Html.RenderDateTimeRange(addedEvent == null ? events.EventDate : addedEvent.EventDate, addedEvent == null ? events.EventEndDate : addedEvent.EventEndDate, SharedLib.Misc.DateTimeFormatter.DefaultStyle)

                                                @Html.RenderDateTimeRange(addedEvent == null ? events.DepartureTime : addedEvent.DepartureTime, addedEvent == null ? events.ReturnTime : addedEvent.ReturnTime, SharedLib.Misc.DateTimeFormatter.Style2, "All day")

                                            </span>
                                            <span class="eo-item eoi-guest">
                                                @if (addedEvent != null)
                                                {
                                                    @(events.PaxCount+" Guest(s)")
                                                }
                                                else if (trip.ShowInventory)
                                                {

                                                    @(events.Inventory.AvailableInventory +" stock left")
                                                }
                                            </span>
                                            <span class="eo-item eoi-usd">
                                                <i class="fa fa-money"></i>
                                                @CurrencyConverter.ToPriceString(events.HostedEvent ? 0 : (addedEvent == null ? (events.PricePerPax ?? 0) : addedEvent.PricePerPAX))
                                            </span>
                                            @if (addedEvent == null)
                                            {
                                                if (events.Inventory.AvailableInventory > 0)
                                                {
                                                    <a class="eo-item eoi-btn btn btn-primary btn-sm right " data-eventid="@events.EventId" onclick="Tariff.JoinEvent(this)">
                                                        Select
                                                    </a>
                                                }

                                            }
                                            else
                                            {
                                                <a class=" btn btn-primary btn-sm right" data-identifier="@addedEvent.Identifier" onclick="Tariff.EditEvent(this)">
                                                    Edit
                                                </a>
                                                <a class="btn btn-danger btn-sm right" data-identifier="@addedEvent.Identifier" onclick="Tariff.Remove(this)">
                                                    Quit
                                                </a>
                                            }
                                        </li>
                                    }
                                </ul>
                            </div>

                        }
                   </div>
                </div>
            </section>
            <section class="detail-footer tour-detail-footer detail-cn">

                <div class="row">
                    <div class="col-lg-3"></div>
                    <div class="col-lg-9 detail-footer-cn text-right">
                        @if (Model.EventGroupId == 0)
                        {
                            var addedEvent = cart.GetAddedEvent(Model.EventEntity.EventId, true);
                            var eventStock = new guestACCESS.Kernel.TripManagement.EventInventory(Model.MasterEventId, true);
                            if (addedEvent == null)
                            {
                                <p class="price-book">
                                    <button type="button" class="awe-btn awe-btn-3 awe-btn-small" onclick="window.history.back();">Back to Previous Page</button>
                                    @if (!string.IsNullOrEmpty(Model.EventEntity.BookingURl))
                                    {
                                        <button type="button" data-type="individual" class="awe-btn awe-btn-1 awe-btn-small join-event-btn" target="_blank" onclick="window.location='@Model.EventEntity.BookingURl'">Book Now</button>
                                    }
                                    else if (eventStock.AvailableInventory > 0)
                                    {
                                        <button type="button" data-type="individual" data-eventtype="@Model.EventEntity.InternalType.ToString()" class="awe-btn awe-btn-1 awe-btn-small join-event-btn" data-eventid="@Model.EventEntity.EventId" onclick="Tariff.JoinEvent(this)">Select</button>
                                    }
                                </p>
                            }
                            else
                            {
                                <p class="price-book">
                                    <button type="button" class="awe-btn awe-btn-3 awe-btn-small" onclick="window.history.back();">Back to Previous Page</button>
                                    <button type="button" class="awe-btn awe-btn-1 awe-btn-small join-event-btn" data-identifier="@addedEvent.Identifier" onclick="Tariff.EditEvent(this)">Edit</button>
                                    <button type="button" class="awe-btn awe-btn-1 awe-btn-small join-event-btn btn-danger" data-identifier="@addedEvent.Identifier" onclick="Tariff.Remove(this)">Delete</button>
                                </p>
                            }
                        }
                    </div>
                </div>
            </section>

        </div>
    </div>

</div>

<!-- End Main -->



@section Additional {


}

